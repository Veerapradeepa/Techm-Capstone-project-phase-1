<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobicom Payment</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.0/font/bootstrap-icons.min.css" rel="stylesheet">
    <style>
        :root {
            /* Custom color scheme */
            --primary: #880e4f;
            --secondary: #ffc107;
            --bg-light: #fffaf6; /* Soft background for the card */
            --text-dark: #333333;
            --text-light: #ffffff;
        }
        
        body {
            background-color: var(--bg-light);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: var(--text-dark);
        }
        
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
            background-color: white;
        }
        
        .logo-text {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .btn-mobicom {
            background: linear-gradient(135deg, var(--primary), #c2185b);
            color: var(--text-light);
            border: none;
            padding: 12px 20px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .btn-mobicom:hover, .btn-mobicom:focus {
            opacity: 0.9;
            color: var(--text-light);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(136, 14, 79, 0.3);
        }
        
        .form-control, .form-select {
            padding: 12px 15px;
            border-radius: 10px;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 0.2rem rgba(136, 14, 79, 0.25);
        }
        
        .payment-method-card {
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 10px;
            padding: 15px 10px;
            text-align: center;
        }
        
        .payment-method-card:hover {
            background-color: rgba(136, 14, 79, 0.05);
        }
        
        .payment-method-card.active {
            background-color: rgba(136, 14, 79, 0.1);
            border: 2px solid var(--primary);
        }
        
        .plan-details {
            background-color: rgba(136, 14, 79, 0.05);
            border-radius: 10px;
            padding: 15px;
        }
        
        .card-icon {
            width: 60px;
            height: 40px;
            border: 1px solid #eee;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 12px;
            background-color: white;
        }
        
        .summary-item {
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        
        .summary-total {
            font-weight: bold;
            font-size: 1.2rem;
            padding-top: 15px;
            margin-top: 10px;
            border-top: 2px solid #eee;
        }

        .text-primary {
            color: var(--primary) !important;
        }

        a {
            color: var(--primary);
        }

        a:hover {
            color: #ad1457;
        }

        .plan-feature-icon {
            color: var(--secondary);
        }

        .badge-plan {
            background-color: var(--secondary);
            color: var(--text-dark);
            font-weight: 600;
        }
        
        .payment-form {
            display: none;
        }
        
        .payment-form.active {
            display: block;
        }
        
        .upi-icons {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .upi-icon {
            width: 50px;
            height: 35px;
            border: 1px solid #eee;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 12px;
            background-color: white;
        }
    </style>
</head>
<body>
    <div class="container py-5">
        <div class="text-center mb-4">
            <div class="logo-text mb-2">MobiComm</div>
            <p class="text-muted">Complete your payment to activate your service</p>
        </div>
        
        <div class="row g-4">
            <!-- Payment Form -->
            <div class="col-lg-8">
                <div class="card p-4">
                    <h5 class="card-title mb-4">Payment Details</h5>
                    
                    <!-- Payment Method Selection -->
                    <div class="row mb-4">
                        <div class="col-md-4">
                            <div class="payment-method-card active" data-method="card">
                                <i class="bi bi-credit-card fs-3 mb-2 text-primary"></i>
                                <div>Credit/Debit Card</div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="payment-method-card" data-method="bank">
                                <i class="bi bi-bank fs-3 mb-2 text-primary"></i>
                                <div>Bank Transfer</div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="payment-method-card" data-method="upi">
                                <i class="bi bi-phone fs-3 mb-2 text-primary"></i>
                                <div>UPI Payment</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Card Payment Form -->
                    <div id="cardPaymentForm" class="payment-form active">
                        <!-- Card Icons -->
                        <div class="d-flex gap-2 mb-4">
                            <div class="card-icon">VISA</div>
                            <div class="card-icon">MC</div>
                            <div class="card-icon">AMEX</div>
                            <div class="card-icon">DISC</div>
                        </div>
                        
                        <form id="paymentFormCard" class="payment-actual-form">
                            <!-- Hidden fields to store recharge data -->
                            <input type="hidden" id="hiddenPlanName" name="planName">
                            <input type="hidden" id="hiddenPlanCharge" name="planCharge">
                            <input type="hidden" id="hiddenSetupFee" name="setupFee">
                            <input type="hidden" id="hiddenTaxesFees" name="taxesFees">
                            <input type="hidden" id="hiddenTotalAmount" name="totalAmount">
                            <input type="hidden" id="hiddenPlanBadge" name="planBadge">
                            <input type="hidden" id="hiddenFeatures" name="features">
                            <input type="hidden" id="hiddenPhoneNumber" name="phoneNumber">
                            <input type="hidden" id="paymentType" name="paymentType" value="card">
                            
                            <div class="mb-3">
                                <label for="cardName" class="form-label">Cardholder Name</label>
                                <input type="text" class="form-control" id="cardName" placeholder="As shown on card" required>
                            </div>
                            
                            <div class="mb-3">
                                <label for="cardNumber" class="form-label">Card Number</label>
                                <div class="input-group">
                                    <input type="text" class="form-control" id="cardNumber" placeholder="1234 5678 9012 3456" required>
                                    <span class="input-group-text"><i class="bi bi-credit-card"></i></span>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="expDate" class="form-label">Expiry Date</label>
                                    <input type="text" class="form-control" id="expDate" placeholder="MM/YY" required>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="cvv" class="form-label">
                                        CVV
                                        <i class="bi bi-question-circle ms-1" data-bs-toggle="tooltip" title="The 3 or 4 digit security code on the back of your card"></i>
                                    </label>
                                    <input type="text" class="form-control" id="cvv" placeholder="123" required>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="address" class="form-label">Billing Address</label>
                                <input type="text" class="form-control" id="address" placeholder="Street Address" required>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="city" class="form-label">City</label>
                                    <input type="text" class="form-control" id="city" placeholder="City" required>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="zipCode" class="form-label">ZIP Code</label>
                                    <input type="text" class="form-control" id="zipCode" placeholder="ZIP / Postal Code" required>
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-mobicom w-100">
                                <span class="button-text">Pay ₹<span class="total-amount-display">0.00</span></span>
                                <span class="spinner-border spinner-border-sm ms-2 d-none" role="status" aria-hidden="true"></span>
                            </button>
                        </form>
                    </div>
                    
                    <!-- Bank Transfer Form -->
                    <div id="bankPaymentForm" class="payment-form">
                        <form id="paymentFormBank" class="payment-actual-form">
                            <input type="hidden" name="paymentType" value="bank">
                            
                            <div class="mb-3">
                                <label for="accountName" class="form-label">Account Holder Name</label>
                                <input type="text" class="form-control" id="accountName" placeholder="Full name on bank account" required>
                            </div>
                            
                            <div class="mb-3">
                                <label for="bankName" class="form-label">Bank Name</label>
                                <select class="form-select" id="bankName" required>
                                    <option value="" selected disabled>Select your bank</option>
                                    <option value="HDFC">HDFC Bank</option>
                                    <option value="SBI">State Bank of India</option>
                                    <option value="ICICI">ICICI Bank</option>
                                    <option value="Axis">Axis Bank</option>
                                    <option value="Kotak">Kotak Mahindra Bank</option>
                                    <option value="PNB">Punjab National Bank</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            
                            <div class="mb-3">
                                <label for="accountNumber" class="form-label">Account Number</label>
                                <input type="text" class="form-control" id="accountNumber" placeholder="Enter account number" required>
                            </div>
                            
                            <div class="mb-3">
                                <label for="ifscCode" class="form-label">IFSC Code</label>
                                <input type="text" class="form-control" id="ifscCode" placeholder="Enter IFSC code" required>
                            </div>
                            
                            <div class="mb-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="confirmConsent" required>
                                    <label class="form-check-label" for="confirmConsent">
                                        I authorize MobiCom to debit my account for the payment amount
                                    </label>
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-mobicom w-100">
                                <span class="button-text">Pay ₹<span class="total-amount-display">0.00</span></span>
                                <span class="spinner-border spinner-border-sm ms-2 d-none" role="status" aria-hidden="true"></span>
                            </button>
                        </form>
                    </div>
                    
                    <!-- UPI Payment Form -->
                    <div id="upiPaymentForm" class="payment-form">
                        <div class="upi-icons">
                            <div class="upi-icon">GPay</div>
                            <div class="upi-icon">PhonePe</div>
                            <div class="upi-icon">Paytm</div>
                            <div class="upi-icon">BHIM</div>
                        </div>
                        
                        <form id="paymentFormUpi" class="payment-actual-form">
                            <input type="hidden" name="paymentType" value="upi">
                            
                            <div class="mb-3">
                                <label for="upiId" class="form-label">UPI ID</label>
                                <div class="input-group">
                                    <input type="text" class="form-control" id="upiId" placeholder="yourname@upi" required>
                                    <span class="input-group-text"><i class="bi bi-phone"></i></span>
                                </div>
                                <small class="text-muted">Enter your UPI ID (e.g. name@okhdfcbank)</small>
                            </div>
                            
                            <div class="mb-3">
                                <label for="upiApp" class="form-label">Select UPI App</label>
                                <select class="form-select" id="upiApp" required>
                                    <option value="" selected disabled>Select UPI app</option>
                                    <option value="gpay">Google Pay</option>
                                    <option value="phonepe">PhonePe</option>
                                    <option value="paytm">Paytm</option>
                                    <option value="bhim">BHIM UPI</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            
                            <div class="mb-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="confirmUpiConsent" required>
                                    <label class="form-check-label" for="confirmUpiConsent">
                                        I authorize MobiCom to send a collect request to my UPI ID
                                    </label>
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-mobicom w-100">
                                <span class="button-text">Pay ₹<span class="total-amount-display">0.00</span></span>
                                <span class="spinner-border spinner-border-sm ms-2 d-none" role="status" aria-hidden="true"></span>
                            </button>
                        </form>
                    </div>
                    
                    <div class="d-flex align-items-center justify-content-center gap-2 mt-4 text-muted">
                        <i class="bi bi-shield-lock"></i>
                        <small>Secure Payment Processing</small>
                    </div>
                </div>
            </div>
            
            <!-- Order Summary -->
            <div class="col-lg-4">
                <div class="card p-4">
                    <h5 class="card-title mb-4">Order Summary</h5>
                    
                    <div class="plan-details mb-4">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <h6 class="fw-bold m-0" id="planName">Loading...</h6>
                            <span class="badge badge-plan" id="planBadge">Loading...</span>
                        </div>
                        <div class="text-muted small" id="planFeatures">
                            <div><i class="bi bi-hourglass-split me-2 plan-feature-icon"></i>Loading features...</div>
                        </div>
                    </div>
                    
                    <div class="summary-item d-flex justify-content-between">
                        <span>Plan Charge</span>
                        <span>₹<span id="planCharge">0.00</span></span>
                    </div>
                    
                    <div class="summary-item d-flex justify-content-between">
                        <span>Setup Fee</span>
                        <span>₹<span id="setupFee">0.00</span></span>
                    </div>
                    
                    <div class="summary-item d-flex justify-content-between">
                        <span>Taxes & Fees</span>
                        <span>₹<span id="taxesFees">0.00</span></span>
                    </div>
                    
                    <div class="summary-total d-flex justify-content-between">
                        <span>Total</span>
                        <span>₹<span id="summaryTotal">0.00</span></span>
                    </div>
                    
                    <div class="mt-4 small text-muted">
                        By completing this payment, you agree to our 
                        <a href="#" class="text-decoration-none">Terms of Service</a> 
                        and 
                        <a href="#" class="text-decoration-none">Privacy Policy</a>.
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Success Modal -->
    <div class="modal fade" id="successModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center p-5">
                    <div class="mb-4">
                        <i class="bi bi-check-circle-fill" style="font-size: 4rem; color: var(--secondary);"></i>
                    </div>
                    <h4 class="mb-3" style="color: var(--primary);">Payment Successful!</h4>
                    <p>Your Mobicom service has been successfully activated.</p>
                    <p id="phoneNumberSuccess" class="mb-2"></p>
                    <p class="mb-0">Order Reference: <strong>MOB-<span id="orderRef"></span></strong></p>
                    <p class="small text-muted">A confirmation email has been sent to your registered email address.</p>
                    <button class="btn btn-mobicom mt-3" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bootstrap JS and Dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <!-- Main Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize tooltips
            const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]');
            const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl));
            
            // Get elements
            const paymentMethods = document.querySelectorAll('.payment-method-card');
            const paymentForms = document.querySelectorAll('.payment-form');
            const cardPaymentForm = document.getElementById('cardPaymentForm');
            const bankPaymentForm = document.getElementById('bankPaymentForm');
            const upiPaymentForm = document.getElementById('upiPaymentForm');
            const actualForms = document.querySelectorAll('.payment-actual-form');
            const successModal = new bootstrap.Modal(document.getElementById('successModal'));
            const orderRef = document.getElementById('orderRef');
            const phoneNumberSuccess = document.getElementById('phoneNumberSuccess');
            
            // Elements for recharge data
            const planName = document.getElementById('planName');
            const planBadge = document.getElementById('planBadge');
            const planFeatures = document.getElementById('planFeatures');
            const planCharge = document.getElementById('planCharge');
            const setupFee = document.getElementById('setupFee');
            const taxesFees = document.getElementById('taxesFees');
            const summaryTotal = document.getElementById('summaryTotal');
            const totalAmountDisplays = document.querySelectorAll('.total-amount-display');
            
            // Hidden form fields
            const hiddenPlanName = document.getElementById('hiddenPlanName');
            const hiddenPlanCharge = document.getElementById('hiddenPlanCharge');
            const hiddenSetupFee = document.getElementById('hiddenSetupFee');
            const hiddenTaxesFees = document.getElementById('hiddenTaxesFees');
            const hiddenTotalAmount = document.getElementById('hiddenTotalAmount');
            const hiddenPlanBadge = document.getElementById('hiddenPlanBadge');
            const hiddenFeatures = document.getElementById('hiddenFeatures');
            const hiddenPhoneNumber = document.getElementById('hiddenPhoneNumber');
            
            // Function to get URL parameters
            function getUrlParams() {
                const params = new URLSearchParams(window.location.search);
                return {
                    planName: params.get('planName') || '',
                    planBadge: params.get('planBadge') || '',
                    planCharge: parseFloat(params.get('planCharge') || 0),
                    setupFee: parseFloat(params.get('setupFee') || 0),
                    taxesFees: parseFloat(params.get('taxesFees') || 0),
                    features: params.get('features'),
                    phoneNumber: params.get('phoneNumber') || ''
                };
            }
            
            // Function to update page with recharge details
            function updatePageWithRechargeDetails() {
                const params = getUrlParams();
                
                // If no URL parameters, try session storage
                if (!params.planName) {
                    checkSessionStorage();
                    return;
                }
                
                // Update plan details
                planName.textContent = params.planName;
                planBadge.textContent = params.planBadge;
                
                // Update features if provided
                if (params.features) {
                    try {
                        // If features are passed as JSON string
                        const featuresArray = JSON.parse(decodeURIComponent(params.features));
                        let featuresHTML = '';
                        
                        featuresArray.forEach(feature => {
                            featuresHTML += `<div><i class="bi bi-check-circle me-2 plan-feature-icon"></i>${feature}</div>`;
                        });
                        
                        planFeatures.innerHTML = featuresHTML;
                    } catch (e) {
                        // If features are passed as comma-separated string
                        try {
                            const featuresArray = decodeURIComponent(params.features).split(',');
                            let featuresHTML = '';
                            
                            featuresArray.forEach(feature => {
                                featuresHTML += `<div><i class="bi bi-check-circle me-2 plan-feature-icon"></i>${feature.trim()}</div>`;
                            });
                            
                            planFeatures.innerHTML = featuresHTML;
                        } catch (e2) {
                            console.error("Error parsing features:", e2);
                            planFeatures.innerHTML = '<div><i class="bi bi-exclamation-triangle me-2 plan-feature-icon"></i>Failed to load features</div>';
                        }
                    }
                }
                
                // Update charges
                planCharge.textContent = params.planCharge.toFixed(2);
                setupFee.textContent = params.setupFee.toFixed(2);
                taxesFees.textContent = params.taxesFees.toFixed(2);
                
                // Calculate and update total
                const total = params.planCharge + params.setupFee + params.taxesFees;
                summaryTotal.textContent = total.toFixed(2);
                
                // Update all total amount displays in buttons
                totalAmountDisplays.forEach(display => {
                    display.textContent = total.toFixed(2);
                });
                
                // Update hidden fields for form submission
                hiddenPlanName.value = params.planName;
                hiddenPlanCharge.value = params.planCharge.toFixed(2);
                hiddenSetupFee.value = params.setupFee.toFixed(2);
                hiddenTaxesFees.value = params.taxesFees.toFixed(2);
                hiddenTotalAmount.value = total.toFixed(2);
                hiddenPlanBadge.value = params.planBadge;
                hiddenFeatures.value = params.features || '';
                hiddenPhoneNumber.value = params.phoneNumber || '';
                
                // Update success message if phone number is provided
                if (params.phoneNumber) {
                    phoneNumberSuccess.textContent = `Phone Number: ${params.phoneNumber}`;
                }
            }
            
            // Check session storage for data from recharge page
            function checkSessionStorage() {
                const storedPlanData = sessionStorage.getItem('mobicomPlanData');
                
                if (storedPlanData) {
                    try {
                        const planData = JSON.parse(storedPlanData);
                        
                        // Update plan details from session storage
                        planName.textContent = planData.planName || 'Plan information unavailable';
                        planBadge.textContent = planData.planBadge || '';
                        
                        // Update features if provided
                        if (planData.features && Array.isArray(planData.features)) {
                            let featuresHTML = '';
                            
                            planData.features.forEach(feature => {
                                featuresHTML += `<div><i class="bi bi-check-circle me-2 plan-feature-icon"></i>${feature}</div>`;
                            });
                            
                            planFeatures.innerHTML = featuresHTML;
                        }
                        
                        // Update charges
                        const planChargeValue = parseFloat(planData.planCharge || 0);
                        const setupFeeValue = parseFloat(planData.setupFee || 0);
                        const taxesFeesValue = parseFloat(planData.taxesFees || 0);
                        
                        planCharge.textContent = planChargeValue.toFixed(2);
                        setupFee.textContent = setupFeeValue.toFixed(2);
                        taxesFees.textContent = taxesFeesValue.toFixed(2);
                        
                        // Calculate and update total
                        const total = planChargeValue + setupFeeValue + taxesFeesValue;
                        summaryTotal.textContent = total.toFixed(2);
                        
                        // Update all total amount displays in buttons
                        totalAmountDisplays.forEach(display => {
                            display.textContent = total.toFixed(2);
                        });
                        
                        // Update hidden fields for form submission
                        hiddenPlanName.value = planData.planName || '';
                        hiddenPlanCharge.value = planChargeValue.toFixed(2);
                        hiddenSetupFee.value = setupFeeValue.toFixed(2);
                        hiddenTaxesFees.value = taxesFeesValue.toFixed(2);
                        hiddenTotalAmount.value = total.toFixed(2);
                        hiddenPlanBadge.value = planData.planBadge || '';
                        hiddenFeatures.value = planData.features ? JSON.stringify(planData.features) : '';
                        hiddenPhoneNumber.value = planData.phoneNumber || '';
                        
                        // Update success message if phone number is provided
                        if (planData.phoneNumber) {
                            phoneNumberSuccess.textContent = `Phone Number: ${planData.phoneNumber}`;
                        }
                    } catch (e) {
                        console.error("Error parsing session storage data:", e);
                        // Try local storage as fallback
                        checkLocalStorage();
                    }
                } else {
                    // Try local storage as fallback
                    checkLocalStorage();
                }
            }
            
            // Check local storage as fallback
            function checkLocalStorage() {
                const storedPlanData = localStorage.getItem('mobicomPlanData');
                
                if (storedPlanData) {
                    try {
                        const planData = JSON.parse(storedPlanData);
                        
                        // Same implementation as session storage but from local storage
                        planName.textContent = planData.planName || 'Plan information unavailable';
                        planBadge.textContent = planData.planBadge || '';
                        
                        // Update features if provided
                        if (planData.features && Array.isArray(planData.features)) {
                            let featuresHTML = '';
                            
                            planData.features.forEach(feature => {
                                featuresHTML += `<div><i class="bi bi-check-circle me-2 plan-feature-icon"></i>${feature}</div>`;
                            });
                            
                            planFeatures.innerHTML = featuresHTML;
                        }
                        
                        // Update charges
                        const planChargeValue = parseFloat(planData.planCharge || 0);
                        const setupFeeValue = parseFloat(planData.setupFee || 0);
                        const taxesFeesValue = parseFloat(planData.taxesFees || 0);
                        
                        planCharge.textContent = planCharplanCharge.textContent = planChargeValue.toFixed(2);
                        setupFee.textContent = setupFeeValue.toFixed(2);
                        taxesFees.textContent = taxesFeesValue.toFixed(2);
                        
                        // Calculate and update total
                        const total = planChargeValue + setupFeeValue + taxesFeesValue;
                        summaryTotal.textContent = total.toFixed(2);
                        
                        // Update all total amount displays in buttons
                        totalAmountDisplays.forEach(display => {
                            display.textContent = total.toFixed(2);
                        });
                        
                        // Update hidden fields for form submission
                        hiddenPlanName.value = planData.planName || '';
                        hiddenPlanCharge.value = planChargeValue.toFixed(2);
                        hiddenSetupFee.value = setupFeeValue.toFixed(2);
                        hiddenTaxesFees.value = taxesFeesValue.toFixed(2);
                        hiddenTotalAmount.value = total.toFixed(2);
                        hiddenPlanBadge.value = planData.planBadge || '';
                        hiddenFeatures.value = planData.features ? JSON.stringify(planData.features) : '';
                        hiddenPhoneNumber.value = planData.phoneNumber || '';
                        
                        // Update success message if phone number is provided
                        if (planData.phoneNumber) {
                            phoneNumberSuccess.textContent = `Phone Number: ${planData.phoneNumber}`;
                        }
                    } catch (e) {
                        console.error("Error parsing local storage data:", e);
                        setDefaultValues();
                    }
                } else {
                    setDefaultValues();
                }
            }
            
            // Set default values if no data is available
            function setDefaultValues() {
                // Default values if no parameters or stored data found
                planName.textContent = 'Premium Plan';
                planBadge.textContent = 'RECOMMENDED';
                
                planFeatures.innerHTML = `
                    <div><i class="bi bi-check-circle me-2 plan-feature-icon"></i>Unlimited data</div>
                    <div><i class="bi bi-check-circle me-2 plan-feature-icon"></i>5G network access</div>
                    <div><i class="bi bi-check-circle me-2 plan-feature-icon"></i>Free roaming</div>
                `;
                
                planCharge.textContent = '799.00';
                setupFee.textContent = '99.00';
                taxesFees.textContent = '118.00';
                
                const total = 799 + 99 + 118;
                summaryTotal.textContent = total.toFixed(2);
                s
                // Update all total amount displays in buttons
                totalAmountDisplays.forEach(display => {
                    display.textContent = total.toFixed(2);
                });
                
                // Update hidden fields with default values
                hiddenPlanName.value = 'Premium Plan';
                hiddenPlanCharge.value = '799.00';
                hiddenSetupFee.value = '99.00';
                hiddenTaxesFees.value = '118.00';
                hiddenTotalAmount.value = total.toFixed(2);
                hiddenPlanBadge.value = 'RECOMMENDED';
                hiddenFeatures.value = JSON.stringify(['Unlimited data', '5G network access', 'Free roaming']);
            }
            
            // Payment method selection
            paymentMethods.forEach(method => {
                method.addEventListener('click', function() {
                    // Deactivate all
                    paymentMethods.forEach(m => m.classList.remove('active'));
                    paymentForms.forEach(f => f.classList.remove('active'));
                    
                    // Activate selected
                    this.classList.add('active');
                    const paymentType = this.getAttribute('data-method');
                    
                    if (paymentType === 'card') {
                        cardPaymentForm.classList.add('active');
                    } else if (paymentType === 'bank') {
                        bankPaymentForm.classList.add('active');
                    } else if (paymentType === 'upi') {
                        upiPaymentForm.classList.add('active');
                    }
                });
            });
            
            // Handle form submissions
            actualForms.forEach(form => {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    // Show loading state
                    const button = this.querySelector('button[type="submit"]');
                    const buttonText = button.querySelector('.button-text');
                    const spinner = button.querySelector('.spinner-border');
                    
                    buttonText.style.opacity = '0.5';
                    spinner.classList.remove('d-none');
                    button.disabled = true;
                    
                    // Simulate API call with timeout
                    setTimeout(() => {
                        // Generate random order reference
                        const randomRef = Math.floor(Math.random() * 9000000) + 1000000;
                        orderRef.textContent = randomRef;
                        
                        // Show success modal
                        successModal.show();
                        
                        // Reset form and button state
                        form.reset();
                        buttonText.style.opacity = '1';
                        spinner.classList.add('d-none');
                        button.disabled = false;
                    }, 2000);
                });
            });
            
            // Load recharge details on page load
            updatePageWithRechargeDetails();
        });
    </script>
</body>
</html>